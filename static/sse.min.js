(function(){var e;htmx.defineExtension("sse",{init:function(t){e=t,htmx.createEventSource==void 0&&(htmx.createEventSource=i)},onEvent:function(t,n){var o,i=n.target||n.detail.elt;switch(t){case"htmx:beforeCleanupElement":o=e.getInternalData(i),o.sseEventSource&&o.sseEventSource.close();return;case"htmx:afterProcessNode":s(i)}}});function i(e){return new EventSource(e,{withCredentials:!0})}function a(s){n(s,"sse-swap").forEach(function(n){var i,a,l,d,u,h,m,r=e.getClosestMatch(n,o);if(r==null)return null;for(h=e.getInternalData(r),l=h.sseEventSource,m=e.getAttributeValue(n,"sse-swap"),d=m.split(","),i=0;i<d.length;i++)u=d[i].trim(),a=function(o){if(t(r))return;if(!e.bodyContains(n)){l.removeEventListener(u,a);return}if(!e.triggerEvent(s,"htmx:sseBeforeMessage",o))return;c(n,o.data),e.triggerEvent(s,"htmx:sseMessage",o)},e.getInternalData(n).sseEventListener=a,l.addEventListener(u,a)}),n(s,"hx-trigger").forEach(function(n){var i,a,c,l,r=e.getClosestMatch(n,o);if(r==null)return null;if(l=e.getInternalData(r),c=l.sseEventSource,i=e.getAttributeValue(n,"hx-trigger"),i==null)return;if(i.slice(0,4)!="sse:")return;a=function(s){if(t(r))return;e.bodyContains(n)||c.removeEventListener(i,a),htmx.trigger(n,i,s),htmx.trigger(n,"htmx:sseMessage",s)},e.getInternalData(s).sseEventListener=a,c.addEventListener(i.slice(4),a)})}function s(t,s){if(t==null)return null;n(t,"sse-connect").forEach(function(t){var n=e.getAttributeValue(t,"sse-connect");if(n==null)return;r(t,n,s)}),a(t)}function r(n,o,i){var a=htmx.createEventSource(o);a.onerror=function(o){if(e.triggerErrorEvent(n,"htmx:sseError",{error:o,source:a}),t(n))return;if(a.readyState===EventSource.CLOSED){i=i||0;var r=Math.random()*(2^i)*500;window.setTimeout(function(){s(n,Math.min(7,i+1))},r)}},a.onopen=function(){e.triggerEvent(n,"htmx:sseOpen",{source:a})},e.getInternalData(n).sseEventSource=a}function t(t){if(!e.bodyContains(t)){var n=e.getInternalData(t).sseEventSource;if(n!=null)return n.close(),!0}return!1}function n(t,n){var s=[];return e.hasAttribute(t,n)&&s.push(t),t.querySelectorAll("["+n+"], [data-"+n+"]").forEach(function(e){s.push(e)}),s}function c(t,n){e.withExtensions(t,function(e){n=e.transformResponse(n,null,t)});var s=e.getSwapSpecification(t),o=e.getTarget(t);e.swap(o,n,s)}function l(t){return function(){t.tasks.forEach(function(e){e.call()}),t.elts.forEach(function(t){t.classList&&t.classList.remove(htmx.config.settlingClass),e.triggerEvent(t,"htmx:afterSettle")})}}function o(t){return e.getInternalData(t).sseEventSource!=null}})()